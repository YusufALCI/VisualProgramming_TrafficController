package com.example.denemecontrol;
import java.util.*;

/// BU SINIFTAN 1 DEN FAZLA NESNE OLUŞTURULMAYACAK VE KULLANILMAYACAKSA STATİC YAPINIZ.
public class ConrollerDemo {
    private Queue<Car> queue1 = new LinkedList<>();
    private Queue<Car> queue2 = new LinkedList<>();
    private Queue<Car> queue3 = new LinkedList<>();
    private Queue<Car> queue4 = new LinkedList<>();
    ///  MANUEL OLARAK ARAÇ ÜRETİLDİ. BU KISMI ORJİNAL KODDA OLMAYACAK DIŞARDAN ALINACAK. \\\
    // Veya araçlar üretilirken kullanılabilir.

    public void AraçÜret() {
        Random random = new Random();
        int[] carSize = {5, 10, 15, 20};
        Queue<Car>[] queues = new Queue[]{queue1, queue2, queue3, queue4};

        for (int i = 0; i < queues.length; i++) {
            for (int j = 0; j < carSize[i]; j++) {
                queues[i].add(new Car(random.nextInt(100), random.nextInt(100)));
            }
        }
    }
    // Bu static olacak işi sonu rahatlık olsun diye şuan değil.
    public void kuyruktanSiktirEtVeGuncelle() {
        //Kuyruklar kuruğu bu.
        Queue<Car>[] queues = new Queue[]{queue1, queue2, queue3, queue4};
        /// Yeşil ışık süresi dışardan gelecek.
        int greenLightDuration = 5000; // 5 saniye
        long tic;
        long toc;

        for (int i = 0; i < queues.length; i++) {
            tic = System.currentTimeMillis();

            while ((toc = System.currentTimeMillis()) - tic < greenLightDuration) {
                Car removedCar = queues[i].poll();
                /// /// Kuyruktan çıkan araç burda ne yapılacaksa artık. fonksiyon sonu retrunda edilebilir.
                if (removedCar == null) {
                    System.out.println("Kuyrukta araç kalmadı.");
                    break;
                }
                System.out.println("Çıkarılan araç: " + removedCar);
                // Kalan araçların pozisyonlarını güncelle
                int pos = 0;
                for (Car c : queues[i]) {
                    c.setPosition(pos * 10, pos * 10); // Örnek bir güncelleme
                    pos++;
                }

                System.out.println("Güncellenmiş kuyruk: " + queues[i]);
                /// BURADA GECİKME EKLEDİM DİĞER ARAÇ EKRANDAN GİTTİKTEN NE KADAR SONRA DİĞERİ KUYRUKTAN ÇIKACAK O BU.
                try {
                    Thread.sleep(1000); // 1 saniye bekle
                } catch (InterruptedException e) {
                    Thread.currentThread().interrupt();
                    System.out.println("Uyuma kesildi.");
                    return;
                }
            }
        }
    }
}

